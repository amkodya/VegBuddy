<?php session_start(); ?>
<!--VEG BUDDY 
*************
users.html.html
*************
 6/23/16
-->
<?php

if(isset($_SESSION["message"])) {
    echo $_SESSION['message'];
    unset($_SESSION['message']);
}

echo "<br /><br /><br />";

$user="root";  //sets the username of the server to  variables
$pass="root";   //sets the password of the username to the variables
$dbh = new PDO('mysql:host=localhost;dbname=vegbuddy;port=8888', $user, $pass); //PDO set into var $dbh - query string links to server and we're given username and pw

if ($_SERVER['REQUEST_METHOD'] =='POST') {  // if the request method is a POST (it is)

        $dbh = new PDO('mysql:host=localhost;dbname=vegbuddy;port=8888', $user, $pass);
        #client name, phone number, email, website

        $firstname = $_POST['firstname']; //get POST values from form - first name
        $lastname = $_POST['lastname']; //get post values from form - lastname
        $gender = $_POST['gender']; //get post values from form - gender
        $zip = $_POST['zip']; //get post values from form - zip

        $stmt = $dbh->prepare("INSERT INTO clients (firstname, lastname, gender, zip) VALUES (:firstname, :lastname, :gender, :zip);");  //prepare statement calling clients table and setting var for the different columns
        $stmt->bindParam(':firstname', $firstname); //sets binding paramater that binds sql data to php data - firstname
        $stmt->bindParam(':lastname', $lastname); //sets binding paramater that binds sql data to php data - lastname
        $stmt->bindParam(':gender', $gender); //sets binding paramater that binds sql data to php data - gender
        $stmt->bindParam(':zip', $zip); //sets binding paramater that binds sql data to php data - zip
        $stmt->execute();  //executes the code to transform sql to php
    }
}

?>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="description" content="Vegan Social Network">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>VegBuddy - The New Hub for Vegans Everywhere</title>
<link href="../css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="../css/style.css">
<link href='https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700' rel='stylesheet' type='text/css'>



</head>
<body>

	<!-- HEADER -->
	<header>
		<div class="container" id="headercust">
        	<div class="navbar-header">
				<img id="mainlogo" src="../images/white_logo.png"><br>
				<h5>The New Hub for Vegans Everywhere</h5>
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            	<span class="sr-only">Toggle navigation</span>
            	<span class="icon-bar"></span>
            	<span class="icon-bar"></span>
            	<span class="icon-bar"></span>
         		</button>
          	</div>

       		<div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li class="active"><!--<img src="user_pic.png"--><a href="login.html">Login</a></li>
                <li id="divider">&nbsp;|&nbsp;</li>
                <li><a href="signup.html">Sign-Up</a></li>
            </ul>
          <!--  <ul class="nav navbar-nav">
                <li class="active"><a href="#">Hello Username!</a></li>
                <li id="divider">&nbsp;|&nbsp;</li>
                <li><a href="#about">3 Messages</a></li>
                <li id="divider">&nbsp;|&nbsp;</li>
                <li><a href="#contact">Logout</a></li>
            </ul> -->
    		</div><!--/.nav-collapse -->
    	
    		<div id="search">
				<form id="newsearch" method="get" action="http://www.google.com">
    			<a href="https://www.facebook.com/VegBuddy"><img id="socmedicon" src="../images/socmedindex-01.png"></a>
    			<a href="https://www.twitter.com/VegBuddy"><img id="socmedicon" style="margin:0 20px 0 5px;" 
    				src="../images/socmedindex-02.png"></a>
		        	<input type="text" id="searchbox" placeholder="&nbsp;&nbsp;SEARCH VEGBUDDY" style="color:#d4d4d4;"></input>
		        	<button type="submit" class="btn btn-primary" aria-label="Left Align">
  						<span class="glyphicon glyphicon-search" aria-hidden="true"></span>
					</button>
				</form>
			</div>
		</div>
	</header>

	<nav class="navbar navbar-inverse" id="subnav">
  		<ul class="nav navbar-nav">
  			<li style="margin-left:2%;"><a href="../index.html">Home</a></li>
  			<li class="dropdown">
  				<a href="recipes.html" class="dropdown-toggle" data-toggle="dropdown" role="button" 
  				aria-haspopup="true" aria-expanded="false">Recipes<span class="caret"></span></a>
          		<ul class="dropdown-menu">
                <li><a href="breakfast.html">Breakfast</a></li>
                <li><a href="lunch.html">Lunch</a></li>
                <li><a href="dinner.html">Dinner</a></li>
                <li><a href="dessert.html">Dessert</a></li>
                <li><a href="snacks.html">Snacks</a></li>
                <li><a href="appetizers.html">Appetizers</a></li>
                <li><a href="drinks.html">Drinks</a></li>
          		</ul>
  			</li>
  			<li><a href="users.html">Users</a></li>
  		<!--	<li><a href="#">Chatrooms</a></li> -->
  		</ul>
	</nav>

	<?php

    $stmt = $dbh->prepare('SELECT * FROM user order by iduser ASC;');  // selects all information from clients table in sql server in order of ascending clientid's
    $stmt->execute();     //execute the previous code that has $stmt variable
    $result = $stmt->fetchAll(PDO::FETCH_ASSOC);   //the result var is set which is the eviqualent of each line item in the sql server
    //The parameter means it will return an indexed array with each index containing an associative array of each row â€“ do a var_dump($result); to see the array results
    //var_dump($result);

    ?>

    <div id="privacy" class="container"> 
			<h3>VEG BUDDY USERS</h3>             
			<table class="table table-hover">
			<tr>

    <?php


    foreach  ($result as $row) {  //foreach loop that will itirate through all the results and set them as var row
        echo '<td>First Name: ' .$row['firstname']. '</br>Last name: ' .$row['lastname']. '<br />Gender: ' .$row['gender']. '<br />Zip: ' . $row['zip'] . '</td>';
    } //echo out every instance of clientid and also display their name, phone#, email, website and forreach loop will not end unless there is no more data

    ?> <!-- close php code  -->

				</tr>
				
			</table>
		</div>

	<!-- FOOTER -->
	<footer>
		<div class="container" id="footer">
			<ul class="nav navbar-nav" id="footernav">
				<li><a href="about.html">ABOUT US</a></li>
				<li><a href="privacy.html">PRIVACY POLICY</a></li>
				<li><a href="sitemap.html">SITE MAP</a></li>
				<li><a href="useragree.html">USER AGREEMENT</a></li>
				<li><a href="contact.html">CONTACT US</a></li><br>
			</ul><br><br>
			<h3>COPYRIGHT 2016 WEB EARTH COOP. 403 EUCLID AVE. SYRACUSE, NY 13023 WEBEARTHCOOP.NET</h3>
		</div>
	</footer>


<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="../js/bootstrap.min.js"></script>


</body>

</html>
